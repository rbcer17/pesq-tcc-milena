---
title: "Analise TCC Milena"
output:
  html_notebook: default
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
---

Carregar primeiro: tidyverse lawstat car readxl (linux package cmake)
```{r}
library(tidyverse)
library(lawstat)
library(car)
```

Importar a planilha de dados

```{r}
library(readxl)
nome_int_no_missing_anova_area_queimada_parque_enso <- read_excel("/home/rbc2/Documents/pesq-tcc-milena/dados/nome-int-no-missing-anova-area-queimada-parque-enso.xlsx")
```

Copiar a planilha importada para o dataframe parqueim

```{r}
parqueim <- nome_int_no_missing_anova_area_queimada_parque_enso
```


Fazendo um boxplot dos dados olhando parques, int vs ext, e el nino

```{r}
boxplot(percentqueim~parque, data=parqueim)
boxplot(percentqueim~tipo, data=parqueim)
boxplot(percentqueim~local, data=parqueim)
```

Removendo o parque do Jalapao da analise

```{r}
parquenj <- parqueim %>%  filter(parque!='jalapao')
```

Repetindo o boxplot sem o jalapao:

```{r}
boxplot(percentqueim~parque, data=parquenj)
boxplot(percentqueim~tipo, data=parquenj)
boxplot(percentqueim~local, data=parquenj)
```

Fazendo transformacao logit da proporcao de area queimada cada parque cada ano e fazendo anova parque vs el nino com interacao e var dependente logit

```{r}
parquenj3 <- parquenj %>% 
  mutate(logitquei = logit(propqueim))
anova3wtudo<-aov(logitquei ~ parque+tipo+parque:tipo, parquenj3)
summary(anova3wtudo)
interaction.plot(parquenj3$parque, parquenj3$tipo, parquenj3$percentqueim)
```

Testando a premissa de normalidade (shapiro) e homoscedascidade (levene) dos residuos

```{r}
shapiro.test(resid(anova3wtudo))
leveneTest(parquenj3$logitquei, parquenj3$parque)
leveneTest(parquenj3$logitquei, parquenj3$tipo)
```

Verificar se ha efeitos significativos interno vs externo

```{r}
anova2wlocal<-aov(logitquei ~ parque+local+parque:local, parquenj3)
summary(anova2wlocal)
```

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
